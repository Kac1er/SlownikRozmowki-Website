"use strict";const hamburgerButton=document.querySelector(".hamburger"),mobileNavigation=document.querySelector(".navbar__list-mobile"),navItems=[...document.querySelectorAll(".navbar__list-mobile a")],navLogo=document.querySelector(".navbar__logo"),exampleButtons=[...document.querySelectorAll(".example__navigation-desktop-button")],exampleImage=document.querySelector(".example__image"),formNameInput=document.querySelector(".order__input--name"),formRodoInput=document.querySelector(".order__input--rodo"),formRegulationsInput=document.querySelector(".order__input--regulations"),formSurrNameInput=document.querySelector(".order__input--surrname"),formEmailInput=document.querySelector(".order__input--email"),formAmountInput=document.querySelector(".order__input--amount"),formSubmitButton=document.querySelector(".order__submit"),formTotalPrice=document.querySelector(".order__total-price"),formTotalAmount=document.querySelector(".order__total-amount"),formCurrentPrice=document.querySelector(".order__current-price"),formCheckboxError=document.querySelector(".order__checkbox-error"),googleCaptcha=document.querySelector(".g-recaptcha"),modal=document.querySelector(".modal"),modalButton=document.querySelector(".modal__button");let activeExampleButton=document.querySelector(".example__navigation-desktop-button--active");const handleMobileNavigation=()=>{hamburgerButton.classList.toggle("hamburger--active"),mobileNavigation.classList.toggle("navbar__list--active"),document.body.classList.toggle("sticky-body")},handleNavbarLogo=()=>{hamburgerButton.classList.contains("hamburger--active")&&handleMobileNavigation()},handleModal=()=>{modal.classList.toggle("modal--active"),document.body.classList.toggle("sticky-body")},toggleActiveExampleButton=e=>{activeExampleButton.classList.remove("example__navigation-desktop-button--active"),e.target.classList.add("example__navigation-desktop-button--active"),activeExampleButton=e.target},changeExampleImage=e=>{exampleImage.src=`./assets/mobile/${e.target.dataset.example}.webp`,toggleActiveExampleButton(e)},showErrorMessage=(e,r)=>{const t=e.nextElementSibling;t.classList.add("order__error-text--active"),t.textContent=r,e.dataset.error="true"},clearErrorMessage=e=>{const r=e.nextElementSibling;r.classList.remove("order__error-text--active"),r.textContent="",e.dataset.error="false"},checkInputValue=e=>{e.forEach(e=>{e.value.trim()?clearErrorMessage(e):showErrorMessage(e,`Pole ${e.previousElementSibling.textContent.slice(0,-1)} jest wymagane.`)})},checkIfNumber=e=>isFinite(e)&&e%1==0&&e>0,checkEmail=e=>{return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.value)?clearErrorMessage(e):showErrorMessage(e,"Podaj poprawny adres email.")},checkAmount=e=>checkIfNumber(parseInt(e.value))?clearErrorMessage(e):showErrorMessage(e,"Podaj poprawną ilość."),showCheckboxError=()=>{formCheckboxError.classList.add("order__checkbox-error--active"),formCheckboxError.dataset.error="true"},clearCheckboxError=()=>{formCheckboxError.classList.remove("order__checkbox-error--active"),formCheckboxError.dataset.error="false"},checkCheckbox=e=>{formCheckboxError.classList.remove("order__checkbox-error--active"),formCheckboxError.dataset.error="false",e.forEach(e=>{e.checked||(formCheckboxError.classList.add("order__checkbox-error--active"),formCheckboxError.dataset.error="true")})},checkForm=e=>{e.preventDefault(),checkInputValue([formNameInput,formSurrNameInput,formEmailInput,formAmountInput]),checkEmail(formEmailInput),checkAmount(formAmountInput),checkCheckbox([formRodoInput]),checkCaptcha(googleCaptcha);(e=>{let r=0;if(e.forEach(e=>{"true"===e.dataset.error&&r++}),0===r){const r=95*parseInt(e[3].value),t={personName:e[0].value,personSurrName:e[1].value,personEmail:e[2].value,orderAmount:e[3].value,orderPrice:r};emailjs.send("default_service","template_62zoe7t",t).then(()=>{handleModal(),emailjs.send("default_service","template_h4o6b34",t)}),clearForm(e)}})([formNameInput,formSurrNameInput,formEmailInput,formAmountInput,googleCaptcha,formCheckboxError])},checkCaptcha=e=>"false"===e.dataset.error?clearErrorMessage(e):showErrorMessage(e,"Zaznacz odpowiednie pole."),countTotalOrderPrice=e=>{const r=parseInt(e.target.value);checkIfNumber(r)?(updateTotalOrderPrice(95*r),updateTotalOrderAmount(r)):updateTotalOrderPrice(0)},clearForm=e=>{formTotalAmount.textContent="0",formTotalPrice.textContent="0",formRodoInput.checked=!1,grecaptcha.reset(),googleCaptcha.dataset.error="true",e.forEach(e=>e.value="")},updateCurrentPrice=()=>formCurrentPrice.textContent=95,updateTotalOrderAmount=e=>formTotalAmount.textContent=e,updateTotalOrderPrice=e=>formTotalPrice.textContent=e;function updateCaptchaStatus(){googleCaptcha.dataset.error="false"}const setIntersectionObserver=()=>{const e=new IntersectionObserver((e,r)=>{e.forEach(e=>{if(e.isIntersecting){const t=e.target;t.src=t.dataset.src,t.classList.remove("lazy-load-image"),r.unobserve(t)}})});document.querySelectorAll("img.lazy-load-image").forEach(r=>{e.observe(r)})},initLibrary=(e,r)=>{const t=document.head,o=document.createElement("script");o.type="text/javascript",o.src=e,t.append(o),r&&(o.async=!0,o.defer=!0)},initLibraries=()=>{initLibrary("https://www.google.com/recaptcha/api.js",!0),initLibrary("https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js",!1),googleCaptcha.dataset.error="true",setTimeout(()=>{emailjs.init("user_HpC2yJwhQIejkLboKnih9")},2e3),formNameInput.removeEventListener("focus",initLibraries)};document.addEventListener("DOMContentLoaded",()=>{navItems.forEach(e=>e.addEventListener("click",handleMobileNavigation)),exampleButtons.forEach(e=>e.addEventListener("click",changeExampleImage)),hamburgerButton.addEventListener("click",handleMobileNavigation),navLogo.addEventListener("click",handleNavbarLogo),formSubmitButton.addEventListener("click",checkForm),formAmountInput.addEventListener("keyup",countTotalOrderPrice),modalButton.addEventListener("click",handleModal),formNameInput.addEventListener("focus",initLibraries),updateCurrentPrice(),setIntersectionObserver()});